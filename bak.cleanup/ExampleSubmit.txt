#FCHGMLVBGXY_2016oct10
#IDT (RNA/DNA)
sample=BS00063A-IDT_BC4_fragment
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTG 5 1 16 R2 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"


#iPCR
#full seq is CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGGGATCTTTGTCCAAACTCATCGAGCTCGGGA
sample=BS00067A-5xBGlo_K562d4_2hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 0 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00068A-5xBGlo_K562d6_2hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 0 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00069A-5xBGlo_K562d10_2hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 0 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00070A-5xBGlo_K562d4_16hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 1 0 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00071A-5xBGlo_K562d6_16hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 1 0 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00072A-5xBGlo_K562d10_16hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 1 0 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00075A-5xBGlo_K562d4_2x16hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 1 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00076A-5xBGlo_K562d6_2x16hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 1 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"

sample=BS00077A-5xBGlo_K562d10_2x16hDpn_iPCR
ds=`echo $sample | cut -d '-' -f1`
name=`echo $sample | cut -d '-' -f2`
echo "$ds $name"
bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 1 16 /vol/mauranolab/flowcells/fastq/FCHGMLVBGXY/Project_Lab/Sample_${ds}/"


#merged iPCR
sample=K562d4_iPCR
indivsamples="~/scratch/transposon/aligned.FCHGMLVBGXY/BS00067A-5xBGlo_K562d4_2hDpn_iPCR ~/scratch/transposon/aligned.FCHGMLVBGXY/BS00070A-5xBGlo_K562d4_16hDpn_iPCR ~/scratch/transposon/aligned.FCHGMLVBGXY/BS00075A-5xBGlo_K562d4_2x16hDpn_iPCR"
bcfiles=`echo $indivsamples | awk 'BEGIN {ORS=" "} {for(i=1; i<=NF; i++) {split($i, path, "/"); print $i "/" path[length(path)] ".barcodes.txt" }}'`
echo -e "Will merge barcode files: $bcfiles\n"
bamfiles=`echo $indivsamples | awk 'BEGIN {ORS=" "} {for(i=1; i<=NF; i++) {split($i, path, "/"); print $i "/" path[length(path)] ".bam" }}'`
echo -e "Will merge bamfiles files: $bamfiles\n"
bqsub -j y -N merge.analyze.${sample} -b y <<EOF
mkdir -p $sample
echo Merging barcodes
cat $bcfiles > $sample/$sample.barcodes.txt
echo Merging bam files
samtools merge -l 9 $sample/$sample.bam $bamfiles
~/scratch/transposon/src/analyzeIntegrations.sh ${sample}
EOF

sample=K562d6_iPCR
indivsamples="~/scratch/transposon/aligned.FCHGMLVBGXY/BS00071A-5xBGlo_K562d6_16hDpn_iPCR ~/scratch/transposon/aligned.FCHGMLVBGXY/BS00068A-5xBGlo_K562d6_2hDpn_iPCR ~/scratch/transposon/aligned.FCHGMLVBGXY/BS00076A-5xBGlo_K562d6_2x16hDpn_iPCR"
bcfiles=`echo $indivsamples | awk 'BEGIN {ORS=" "} {for(i=1; i<=NF; i++) {split($i, path, "/"); print $i "/" path[length(path)] ".barcodes.txt" }}'`
echo -e "Will merge barcode files: $bcfiles\n"
bamfiles=`echo $indivsamples | awk 'BEGIN {ORS=" "} {for(i=1; i<=NF; i++) {split($i, path, "/"); print $i "/" path[length(path)] ".bam" }}'`
echo -e "Will merge bamfiles files: $bamfiles\n"
bqsub -j y -N merge.analyze.${sample} -b y <<EOF
mkdir -p $sample
echo Merging barcodes
cat $bcfiles > $sample/$sample.barcodes.txt
echo Merging bam files
samtools merge -l 9 $sample/$sample.bam $bamfiles
~/scratch/transposon/src/analyzeIntegrations.sh ${sample}
EOF

sample=K562d10_iPCR
indivsamples="~/scratch/transposon/aligned.FCHGMLVBGXY/BS00069A-5xBGlo_K562d10_2hDpn_iPCR ~/scratch/transposon/aligned.FCHGMLVBGXY/BS00072A-5xBGlo_K562d10_16hDpn_iPCR ~/scratch/transposon/aligned.FCHGMLVBGXY/BS00077A-5xBGlo_K562d10_2x16hDpn_iPCR"
bcfiles=`echo $indivsamples | awk 'BEGIN {ORS=" "} {for(i=1; i<=NF; i++) {split($i, path, "/"); print $i "/" path[length(path)] ".barcodes.txt" }}'`
echo -e "Will merge barcode files: $bcfiles\n"
bamfiles=`echo $indivsamples | awk 'BEGIN {ORS=" "} {for(i=1; i<=NF; i++) {split($i, path, "/"); print $i "/" path[length(path)] ".bam" }}'`
echo -e "Will merge bamfiles files: $bamfiles\n"
bqsub -j y -N merge.analyze.${sample} -b y <<EOF
mkdir -p $sample
echo Merging barcodes
cat $bcfiles > $sample/$sample.barcodes.txt
echo Merging bam files
samtools merge -l 9 $sample/$sample.bam $bamfiles
~/scratch/transposon/src/analyzeIntegrations.sh ${sample}
EOF


##FCHWLJCBGXY_2016oct24
##RNA/DNA
#sample=BS00064A-5xBGlo_K562d4_DNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 4 0 16 R2 /vol/mauranolab/flowcells/fastq/FCHWLJCBGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00065A-5xBGlo_K562d6_DNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 4 1 16 R2 /vol/mauranolab/flowcells/fastq/FCHWLJCBGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00066A-5xBGlo_K562d10_DNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 5 0 16 R2 /vol/mauranolab/flowcells/fastq/FCHWLJCBGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00073A-5xBGlo_K562d6_RNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 0 16 R1 /vol/mauranolab/flowcells/fastq/FCHWLJCBGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00074A-5xBGlo_K562d10_RNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 1 1 16 R1 /vol/mauranolab/flowcells/fastq/FCHWLJCBGXY/Project_Lab/Sample_${ds}/"
#
#
##FCHWG37BGXY_2016nov04
##iPCR
#sample=BS00101A-Bglo_K562d5_Max_iPCR
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 1 16 /vol/mauranolab/flowcells/fastq/FCHWG37BGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00102A-Bglo_K562d5_JM109_iPCR
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitIntegrations.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 1 0 16 /vol/mauranolab/flowcells/fastq/FCHWG37BGXY/Project_Lab/Sample_${ds}/"
#
#
##RNA/DNA
#sample=BS00073B-5xBGlo_K562d6_RNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 0 0 16 R1 /vol/mauranolab/flowcells/fastq/FCHWG37BGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00103A-BGloGFPBC4_MAX_Plasmid
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 4 0 16 R2 /vol/mauranolab/flowcells/fastq/FCHWG37BGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00104A-BGloGFPBC4_JM109_Plasmid
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 5 1 16 R2 /vol/mauranolab/flowcells/fastq/FCHWG37BGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00105A-Bglo_K562d5_Max_DNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 4 0 16 R2 /vol/mauranolab/flowcells/fastq/FCHWG37BGXY/Project_Lab/Sample_${ds}/"
#
#sample=BS00106A-Bglo_K562d5_JM109_DNA
#ds=`echo $sample | cut -d '-' -f1`
#name=`echo $sample | cut -d '-' -f2`
#echo "$ds $name"
#bqsub -j y -N submit.${ds}-${name} -b y "~/scratch/transposon/src/submitBCcounts.sh ${ds}-${name} CCTTTCTAGGCAATTAGGBBBBBBBBBBBBBBBBGCTAGTTGTGG 5 1 16 R2 /vol/mauranolab/flowcells/fastq/FCHWG37BGXY/Project_Lab/Sample_${ds}/"